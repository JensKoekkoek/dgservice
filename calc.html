<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>DG Service - Calculator</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicons -->
    <link href="img/favicon.png" rel="icon">
    <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Ruda:400,900,700" rel="stylesheet">

    <!-- Bootstrap CSS File -->
    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Libraries CSS Files -->
    <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="lib/prettyphoto/css/prettyphoto.css" rel="stylesheet">
    <link href="lib/hover/hoverex-all.css" rel="stylesheet">
    <link href="lib/jetmenu/jetmenu.css" rel="stylesheet">
    <link href="lib/owl-carousel/owl-carousel.css" rel="stylesheet">

    <!-- Main Stylesheet File -->
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="css/colors/blue.css">
</head>

<body>
    <header class="header">
        <div class="container">
            <div class="site-header clearfix">
                <div class="col-lg-3 col-md-3 col-sm-12 title-area">
                    <div class="site-title" id="title">
                        <a href="index.html" title="">
                            <h4>DG<span>Service</span></h4>
                        </a>
                    </div>
                </div>
                <!-- title area -->
                <div class="col-lg-9 col-md-12 col-sm-12">
                    <div id="nav" class="right">
                        <div class="container clearfix">
                            <ul id="jetmenu" class="jetmenu blue">
                                <li><a href="index.html">Home</a>
                                </li>
                                <li><a href="ranks.html">RANKS</a>
                                </li>
                                <li><a href="leeching.html">LEECHING</a>
                                </li>
                                <li><a href="rules.html">RULES</a>
                                </li>
                                <li><a href="prices.html">PRICES</a>
                                </li>
                                <li>
                                    <a href="dxp.html">DXP</a>
                                </li>
                                <li><a
                                        href="https://docs.google.com/forms/d/e/1FAIpQLSc8CYeGCUwZVYhaga0NNt7IHTYve4rGHlJHhuH0LwqebJkoWA/viewform">APPLY</a>
                                </li>
                                <li class="active"><a href="calc.html">CALC</a> </li>
                            </ul>
                        </div>
                    </div>
                    <!-- nav -->
                </div>
                <!-- title area -->
            </div>
            <!-- site header -->
        </div>
        <!-- end container -->
    </header>
    <!-- end header -->

    <section id="intro">
        <div class="container">
            <div class="ror">
                <div class="col-md-8 col-md-offset-2">
                    <h1>DG Service</h1>
                    <p>THE #1 FC FOR ALL YOUR DUNGEONEERING NEEDS!</p>
                </div>
            </div>
        </div>
    </section>

    <section class="section1">
        <div class="container clearfix">
            <center>
                <h1>Calculator</h1>
                <p>The calculated price is an estimate. <b>Never</b> pay this amount in full to anyone - always pay per
                    floor!</p>
                <form id="calcForm">
                    <div class="form-group row">
                        <label for="goalTypeSelect" class="col-sm-2 col-form-label">Goal type</label>
                        <div class="col-sm-10">
                            <select class="form-control" id="goalTypeSelect" onchange="setDropDownText()">
                                <option value="level">Level</option>
                                <option value="tokensGained">Tokens gained</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="textboxStart" class="col-sm-2 col-form-label">Starting level or XP</label>
                        <div class="col-sm-10">
                            <input type="number" class="form-control" id="textboxStart"
                                placeholder="Starting level or XP">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="textboxEnd" class="col-sm-2 col-form-label">Target level</label>
                        <div class="col-sm-10">
                            <input type="number" class="form-control" id="textboxEnd" placeholder="Target level">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="amountbxp" class="col-sm-2 col-form-label">Bonus XP</label>
                        <div class="col-sm-10">
                            <input type="number" class="form-control" id="amountbxp" placeholder="Bonus XP" value="0">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-2">XP cards</div>
                        <div class="col-sm-10">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="cardedaba">
                                <label class="form-check-label" for="cardedaba">
                                    2.5x abandoned 2
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="cardedocc">
                                <label class="form-check-label" for="cardedocc">
                                    2.5x occult
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="cardedwarp">
                                <label class="form-check-label" for="cardedwarp">
                                    2.5x warped
                                </label>
                            </div>
                            <div class="form-check">
                                <select id="cardedTypeSelect">
                                    <option value="1leech">1 leech</option>
                                    <option value="2leech" selected>2-3 leeches</option>
                                </select>
                                <div class="test"> ?
                                    <span class="tooltiptext">Select 2-3 leeches if you only plan on buying carded
                                        floors with someone
                                        else for the reduced price. Select 1 leech if you plan on buying carded floors
                                        solo for double the price.</span>
                                </div><br>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-2">Other bonuses</div>
                        <div class="col-sm-10">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="dxp">
                                <label class="form-check-label" for="dxp">
                                    Double XP weekend?
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="outfit">
                                <label class="form-check-label" for="outfit">
                                    Warped Gorajan trailblazer outfit?
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <button type="submit">Calculate</button>
                    </div>
                </form>
                <p id="text1"> </p>
                <p id="ol1"> </p>
                <p id="text2"> </p>
                <p id="ol5"> </p>
                <p id="ol3"> </p>
                <p id="ol4"> </p>
                <strong>
                    <p id="ol6"> </p>
                </strong>
                <strong>
                    <p id="ol7"> </p>
                </strong>
                <p id="o18"> </p>
            </center>
        </div>

        <!-- end container -->
    </section>
    <!-- end section 1 -->


    <div class="copyrights">
        <div class="container">
            <div class="col-lg-12 col-md-12 col-sm-12 columns footer-left">
                <p>Copyright Â© 2019 DG Service - All rights reserved.</p>
            </div>
            <!-- end widget -->

        </div>
        <!-- end container -->
    </div>
    <!-- end copyrights -->
    </footer>
    <!-- end footer -->
    <div class="dmtop">Scroll to Top</div>

    <!-- JavaScript Libraries -->
    <script src="lib/jquery/jquery.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="lib/php-mail-form/validate.js"></script>
    <script src="lib/prettyphoto/js/prettyphoto.js"></script>
    <script src="lib/isotope/isotope.min.js"></script>
    <script src="lib/hover/hoverdir.js"></script>
    <script src="lib/hover/hoverex.min.js"></script>
    <script src="lib/unveil-effects/unveil-effects.js"></script>
    <script src="lib/owl-carousel/owl-carousel.js"></script>
    <script src="lib/jetmenu/jetmenu.js"></script>
    <script src="lib/animate-enhanced/animate-enhanced.min.js"></script>
    <script src="lib/jigowatt/jigowatt.js"></script>
    <script src="lib/easypiechart/easypiechart.min.js"></script>

    <!-- Template Main Javascript File -->
    <script src="js/main.js"></script>

    <script>
        //19/Aug/2017 - calc for dg xp by Jaguaro
        var LevelXP = [
            0, 83, 174, 276, 388,//5
            512, 650, 801, 969, 1154,//10
            1358, 1584, 1833, 2107, 2411,//15
            2746, 3115, 3523, 3973, 4470,//20
            5018, 5624, 6291, 7028, 7842,//25
            8740, 9730, 10824, 12031, 13363,//30
            14833, 16456, 18247, 20224, 22406,//35
            24815, 27473, 30408, 33648, 37224,//40
            41171, 45529, 50339, 55649, 61512,//45
            67983, 75127, 83014, 91721, 101333,//50
            111945, 123660, 136594, 150872, 166636,//55
            184040, 203254, 224466, 247886, 273742,//60
            302288, 333804, 368599, 407015, 449428,//65
            496254, 547953, 605032, 668051, 737627,//70
            814445, 899257, 992895, 1096278, 1210421,//75
            1336443, 1475581, 1629200, 1798808, 1986068,//80
            2192818, 2421087, 2673114, 2951373, 3258594,//85
            3597792, 3972294, 4385776, 4842295, 5346332,//90
            5902831, 6517253, 7195629, 7944614, 8771558,//95
            9684577, 10692629, 11805606, 13034431, 14391160,//100
            15889109, 17542976, 19368992, 21385073, 23611006,//105
            26068632, 28782069, 31777943, 35085654, 38737661,//110
            42769801, 47221641, 52136869, 57563718, 63555443,//115
            70170840, 77474828, 85539082, 94442737, 104273167];//120
        var Ticked = [0];

        function Calcu() {

            var flc1n, flc1a, flm, fla, flo, flw, flhw, LS, XS, LE, XE, RushNum, P, initial, BXP, xpmult;
            var m1, m2, m3, m4, c1, c2, c3, c4;
            flc1n = flc1a = flm = fla = flo = flw = flhw = LS = XS = LE = XE = RushNum = P = initial = 0;
            m1 = m2 = m3 = m4 = c1 = c2 = c3 = c4 = 0;
            Ticked = [0];
            //The prices per floor
            var Cc1n = 230 * 1000;
            var Cc1a = 460 * 1000;
            var Cm = 750 * 1000;
            var Ca = 2000 * 1000;
            var Co = 2250 * 1000;
            var Cw = 2750 * 1000;
            var Chw = 3000 * 1000;

            if (document.getElementById("dxp").checked) {
                Cc1n *= 1.5;
                Cc1a *= 1.5;
                Cm *= 1.5;
                Ca *= 1.5;
                Co *= 1.5;
                Cw *= 1.5;
                Chw *= 1.5;
            }

            var c1nTime = 2;
            var c1aTime = 3.5;
            var medTime = 7;
            var largeTime = 10;

            var txp = parseFloat(document.getElementById("textboxStart").value);
            var LE = parseFloat(document.getElementById("textboxEnd").value);
            var amountbxp = parseFloat(document.getElementById("amountbxp").value);

            if (txp >= 1 && txp <= 120)//if Starting lvl is entered, gets xp at that lvl
            {
                LS = parseFloat(document.getElementById("textboxStart").value);
                XS = LVLtoXP(LS);
                initial = LVLtoXP(LS);
            }
            if (txp > 200)//if Starting xp is entered, gets lvl at that xp
            {
                XS = parseFloat(document.getElementById("textboxStart").value);
                LS = XPtoLVL(XS);
                initial = parseFloat(document.getElementById("textboxStart").value);
            }

            if (document.getElementById("goalTypeSelect").value == "tokensGained") {
                XE = XS + LE * 10;
            }
            else {
                XE = LVLtoXP(LE);
            }
            xpmult = 1.0;
            if (document.getElementById("dxp").checked == true) {
                xpmult = xpmult + 1;
                var dxp = true;
            }

            if (document.getElementById("outfit").checked == true) {
                xpmult = xpmult + 0.07;
            }

            if (Math.floor((XPtoLVL(XS) + 1) / 2) <= 60)//gets previous progress number for prestige
            {
                P = Math.floor((XPtoLVL(XS) + 1) / 2);
            }
            else if (Math.floor((XPtoLVL(XS) + 1) / 2) > 60) {
                P = 60;
            }
            for (i = 0; XS <= XE; i++)//does a floor until xp meets the goal
            {
                if (Math.floor((XPtoLVL(XS) + 1) / 2) <= 60)//gets the max floor
                {
                    MaxF = Math.floor((XPtoLVL(XS) + 1) / 2);
                }
                else if (Math.floor((XPtoLVL(XS) + 1) / 2) > 60) {
                    MaxF = 60;
                }

                if (Math.max.apply(null, Ticked) + 1 <= MaxF)//adds the xp of the floor if the floor is available
                {
                    if (Math.max.apply(null, Ticked) + 1 > P)//if current floor is greater than previous prestige, current is now prestige
                    {
                        P = Math.max.apply(null, Ticked) + 1;
                    }
                    FloorXP = FFL(Math.max.apply(null, Ticked) + 1, P, XPtoLVL(XS), true);//calls method for calculating floor xp
                    if (amountbxp > FloorXP) {
                        xpmult += 1;
                        amountbxp -= FloorXP;
                        FloorXP *= xpmult;
                        xpmult -= 1;
                    }
                    else if (amountbxp > 0) {
                        FloorXP *= xpmult;
                        FloorXP += amountbxp;
                        amountbxp = 0;
                    }
                    else {
                        FloorXP *= xpmult;
                    }
                    XS += FloorXP;
                }
                else {
                    //if it reaches max floor, it resets and sets prestige
                    P = Math.max.apply(null, Ticked);
                    Ticked = [0];
                }
            }

            function FFL(FNum, PNum, CLvl)//method for calculating floor xp
            {
                var FMod = 0;
                var Rush = false, Med = false, Larg = false;
                if (CLvl <= 34)//if current lvl is less then 34, all floors are med
                {
                    Med = true;
                }
                if (CLvl >= 35 && CLvl <= 58)//rushs froz, rest med
                {
                    if (FNum <= 11) {
                        Rush = true;
                    }
                    else
                        Med = true;
                }
                if (CLvl >= 59 && CLvl <= 69)//rushs 1-24, med 25-29, larg 30+
                {
                    if (FNum <= 24) {
                        Rush = true;
                    }
                    if (FNum >= 25 && FNum <= 29) {
                        Med = true;
                    }
                    if (FNum >= 30) {
                        Larg = true;
                    }
                }
                if (CLvl >= 70)//rushs 1-29, 30+ larg
                {
                    if (FNum <= 29) {
                        Rush = true;
                    }
                    else
                        Larg = true;
                }
                if (FNum != 0 && Rush == true) {

                    RushNum++;//adds a rush to the total rushed floors

                }
                if (FNum != 0 && Med == true) {
                    m1 = 0.0012;
                    m2 = -0.0203;
                    m3 = 0.8909;
                    m4 = 3.5366;
                    c1 = 0.3833;
                    c2 = -8.9034;
                    c3 = 272.45;
                    c4 = 838.82;
                    FMod = 1.1;//final mod for medium floor

                    flm++;//adds a med

                }
                if (FNum != 0 && Larg == true) {
                    m1 = 0.0015;
                    m2 = 0.0026;
                    m3 = 1.2126;
                    m4 = 8.8089;
                    c1 = 0.3807;
                    c2 = 3.4423;
                    c3 = 263.03;
                    c4 = 2015;
                    FMod = 1.33;//final mod for large
                    if (FNum >= 30 && FNum <= 35)//adds all the themes
                    {
                        fla++;
                    }
                    if (FNum >= 36 && FNum <= 47) {
                        flo++;
                    }
                    if (FNum >= 48 && FNum <= 56) {
                        flw++;
                    }
                    if (FNum >= 57 && FNum <= 60) {
                        flhw++;
                    }

                }
                //polynomail appoximating  base floor xp as a function of floor number
                var FloorXP = E(FNum, FNum); //base current floor xp
                var PrestigeXP = E(PNum, FNum); //base prestige floor xp
                var FFinal = Math.floor((FloorXP + PrestigeXP) / 2) * FMod; //gets average of floor and prestige, applies mod and % increase
                if (FNum >= 30 && FNum <= 35 && document.getElementById("cardedaba").checked) {
                    FFinal *= 2.5;
                }
                else if (FNum >= 36 && FNum <= 47 && document.getElementById("cardedocc").checked) {
                    FFinal *= 2.5;
                }
                else if (FNum >= 48 && document.getElementById("cardedwarp").checked) {
                    FFinal *= 2.5;
                }
                Ticked.push(FNum);//ticks the floor off
                return FFinal;
            }

            function E(pn, fn) {
                var m = m1 * Math.pow(pn, 3) + m2 * Math.pow(pn, 2) + m3 * Math.pow(pn, 1) + m4 * Math.pow(pn, 0);
                var c = c1 * Math.pow(pn, 3) + c2 * Math.pow(pn, 2) + c3 * Math.pow(pn, 1) + c4 * Math.pow(pn, 0);
                var y = m * fn + c;
                return y;
            }

            function XPtoLVL(xpIN)//converts xp to level
            {
                var LvlCalc = 0;
                var input = xpIN;
                if (input >= LevelXP[119]) {
                    LvlCalc = 120;
                }
                else {
                    for (i = 0; input >= LevelXP[i]; i++) {
                        LvlCalc = i + 1;
                    }
                }
                return LvlCalc;
            }

            function LVLtoXP(lvlin)//converts lvl to xp
            {
                return LevelXP[lvlin - 1];
            }

            function numberWithCommas(x) {
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            if (document.getElementById("cardedaba").checked) {
                if (document.getElementById("cardedTypeSelect").value == "2leech") {
                    Ca *= 2.5;
                }
                else if (dxp) {
                    Ca *= 3;
                }

                else {
                    Ca *= 5;
                }
            }

            if (document.getElementById("cardedocc").checked) {
                if (document.getElementById("cardedTypeSelect").value == "2leech") {
                    Co *= 2.5;
                }
                else if (dxp) {
                    Co *= 3;
                }

                else {
                    Co *= 5;
                }
            }

            if (document.getElementById("cardedwarp").checked) {
                if (document.getElementById("cardedTypeSelect").value == "2leech") {
                    Cw *= 2.5;
                    Chw *= 2.5;
                }
                else if (dxp) {
                    Cw *= 3;
                    Chw *= 3;
                } else {
                    Cw *= 5;
                    Chw *= 5;
                }
            }

            var wrushcost = RushNum * Cc1n + flm * Cm + fla * Ca + flo * Co + flw * Cw + flhw * Chw;
            var warushcost = RushNum * Cc1a + flm * Cm + fla * Ca + flo * Co + flw * Cw + flhw * Chw;
            var worushcost = Cc1n + flm * Cm + fla * Ca + flo * Co + flw * Cw + flhw * Chw;

            var withNonAFKRushTime = RushNum * c1nTime + flm * medTime + (fla + flo + flw + flhw) * largeTime;
            var withAFKRushTime = RushNum * c1aTime + flm * medTime + (fla + flo + flw + flhw) * largeTime;

            document.getElementById("ol1").innerHTML = "C1-[" + RushNum + "], Med-[" + flm + "], Ab-[" + fla + "], Oc-[" + flo + "], Wa-[" + flw + "], HW-[" + flhw + "]";
            document.getElementById("ol3").innerHTML = "with afk rushes:   " + Math.round(warushcost / 1000000) + "m, @" + Math.round(warushcost / (XS - initial)) + " gp/xp";
            document.getElementById("ol4").innerHTML = "with non-afk rushes:  " + Math.round(wrushcost / 1000000) + "m, @" + Math.round(wrushcost / (XS - initial)) + " gp/xp";
            document.getElementById("ol5").innerHTML = "without rushes:      " + Math.round(worushcost / 1000000) + "m, @" + Math.round(worushcost / (XS - initial)) + " gp/xp";
            document.getElementById("ol6").innerHTML = "xp gained:       " + numberWithCommas(Math.round((XS - initial)));
            document.getElementById("ol7").innerHTML = "Tokens gained:       " + numberWithCommas(Math.round((XS - initial) / 10));
            document.getElementById("o18").innerHTML = "<b>Total in-floor time spent:</b><br/>" + numberWithCommas(Math.round(withNonAFKRushTime / 60)) + " hours with non-AFK rushes<br/> " + numberWithCommas(Math.round(withAFKRushTime / 60)) + " hours with AFK rushes";

            document.getElementById("text1").innerHTML = "<b>Floors that will be done:</b>";
            document.getElementById("text2").innerHTML = "<b>Total price:</b>";

        }

        function setDropDownText() {
            if (document.getElementById("goalTypeSelect").value == "level") {
                document.querySelector("label[for='textboxEnd']").innerHTML = document.querySelector("#textboxEnd").placeholder = "Target level";
            }

            else if (document.getElementById("goalTypeSelect").value == "tokensGained") {
                document.querySelector("label[for='textboxEnd']").innerHTML = document.querySelector("#textboxEnd").placeholder= "Desired tokens gained";
            }
        }

        $(() => {
            document.querySelector("#calcForm").addEventListener("submit", e => { e.preventDefault(); Calcu(); });
        });
    </script>
</body>

</html>